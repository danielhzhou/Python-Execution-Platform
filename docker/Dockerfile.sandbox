FROM python:3.11-slim

# Set environment variables
ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1
ENV TERM=xterm-256color

# Install system dependencies
RUN apt-get update && apt-get install -y \
    build-essential \
    curl \
    git \
    nano \
    vim \
    tree \
    htop \
    procps \
    && rm -rf /var/lib/apt/lists/*

# Create non-root user with home directory
RUN groupadd -r pyuser && useradd -r -g pyuser -u 1000 -m pyuser

# Install Python packages that are commonly needed
RUN pip install --no-cache-dir \
    pandas==2.1.4 \
    scipy==1.11.4 \
    numpy==1.25.2 \
    matplotlib==3.8.2 \
    seaborn==0.13.0 \
    scikit-learn==1.3.2 \
    requests==2.31.0 \
    jupyter==1.0.0 \
    ipython==8.18.1 \
    pytest==7.4.3 \
    black==23.11.0 \
    flake8==6.1.0 \
    mypy==1.7.1

# Create workspace directory
RUN mkdir -p /workspace && chown pyuser:pyuser /workspace

# Set working directory
WORKDIR /workspace

# Switch to non-root user
USER pyuser

# Add welcome message to bashrc
RUN echo 'echo "🐍 Python Execution Environment Ready!"' >> /home/pyuser/.bashrc && \
    echo 'echo "📦 Pre-installed: pandas, scipy, numpy, matplotlib, scikit-learn"' >> /home/pyuser/.bashrc && \
    echo 'echo "💻 Available: python, pip, git, nano, vim"' >> /home/pyuser/.bashrc && \
    echo 'echo "📁 Working directory: /workspace"' >> /home/pyuser/.bashrc && \
    echo 'echo ""' >> /home/pyuser/.bashrc

# Default command
CMD ["/bin/bash"] 